---
const projects = [
  {
    url: "https://images.pexels.com/photos/3987066/pexels-photo-3987066.jpeg",
    title: "Finance App Redesign",
    slug: "finance-app",
    width: "480px"
  },
  {
    url: "https://images.pexels.com/photos/1516680/pexels-photo-1516680.jpeg",
    title: "E-commerce Website",
    slug: "ecommerce-website",
    width: "360px"
  },
  {
    url: "https://images.pexels.com/photos/3683074/pexels-photo-3683074.jpeg",
    title: "Health & Wellness Platform",
    slug: "health-platform",
    width: "480px"
  },
  {
    url: "https://images.pexels.com/photos/2007401/pexels-photo-2007401.jpeg",
    title: "Travel Booking App",
    slug: "travel-app",
    width: "360px"
  },
  {
    url: "https://images.pexels.com/photos/1763075/pexels-photo-1763075.jpeg",
    title: "Music Streaming Dashboard",
    slug: "music-dashboard",
    width: "480px"
  }
];
---

<section class="photo-banner">
  <div class="container">
    <h2 class="banner-title">Featured Projects</h2>
  </div>
  <div class="banner-content">
    <div class="scroll-track">
      {[...projects, ...projects].map((project) => (
        <a 
          href={`/work/${project.slug}`} 
          class="photo-item"
          style={`width: ${project.width};`}
        >
          <img 
            src={project.url} 
            alt={project.title}
            loading="lazy"
            decoding="async"
            fetchpriority="low"
          />
        </a>
      ))}
    </div>
    <div class="gradient-overlay left"></div>
    <div class="gradient-overlay right"></div>
  </div>
</section>

<style>
  .photo-banner {
    position: relative;
    width: 100vw;
    overflow: hidden;
    padding: 0 0 var(--space-6) 0;
    margin-top: calc(var(--space-6) * -1);
    opacity: 0;
    transform: translateY(30px);
    animation: revealBanner 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: 1.4s;
    left: 50%;
    right: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    will-change: transform, opacity;
  }

  .banner-title {
    font-size: clamp(2rem, 5vw, 3rem);
    margin-bottom: calc(var(--space-7) * 0.25);
    opacity: 0;
    transform: translateY(20px);
    animation: revealTitle 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: 1.2s;
    will-change: transform, opacity;
  }

  .banner-content {
    width: 100%;
    overflow: hidden;
    position: relative;
    opacity: 0;
    animation: fadeIn 0.4s ease forwards;
    animation-delay: 1.6s;
  }

  .scroll-track {
    display: flex;
    gap: var(--space-4);
    animation: scroll 30s linear infinite;
    animation-play-state: paused;
    width: max-content;
    padding: var(--space-7) 0;
    will-change: transform;
  }

  .scroll-track.loaded {
    animation-play-state: running;
  }

  .photo-item {
    border-radius: 8px;
    overflow: hidden;
    display: block;
    height: 360px;
    transform: scale(0.98);
    transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: transform;
    opacity: 0;
    animation: fadeIn 0.4s ease forwards;
    animation-delay: calc(1.6s + var(--delay, 0s));
  }

  .photo-item:hover {
    transform: scale(1);
  }

  .photo-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .gradient-overlay {
    position: absolute;
    top: 0;
    height: 100%;
    width: 8vw;
    pointer-events: none;
    z-index: 2;
    opacity: 0;
    transition: opacity 0.4s ease;
    will-change: opacity;
  }

  .gradient-overlay.left {
    left: 0;
    background: linear-gradient(
      to right,
      rgba(255, 255, 255, 1) 20%,
      rgba(255, 255, 255, 0)
    );
  }

  .gradient-overlay.right {
    right: 0;
    background: linear-gradient(
      to left,
      rgba(255, 255, 255, 1) 20%,
      rgba(255, 255, 255, 0)
    );
  }

  @keyframes revealBanner {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes revealTitle {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes scroll {
    to {
      transform: translateX(-50%);
    }
  }

  @media (max-width: 768px) {
    .photo-item {
      width: 300px !important;
      height: 360px !important;
    }
    
    .gradient-overlay {
      width: 12vw;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const scrollTrack = document.querySelector('.scroll-track');
    const images = document.querySelectorAll('.photo-item img');
    const overlays = document.querySelectorAll('.gradient-overlay');
    const photoItems = document.querySelectorAll('.photo-item');
    
    let imagesLoaded = 0;
    const totalImages = images.length;

    function handleImageLoad() {
      imagesLoaded++;
      if (imagesLoaded === totalImages) {
        scrollTrack?.classList.add('loaded');
        overlays.forEach(overlay => {
          overlay.style.opacity = '1';
        });
        
        photoItems.forEach((item, index) => {
          item.style.setProperty('--delay', `${index * 0.1}s`);
        });
      }
    }

    images.forEach(img => {
      if (img.complete) {
        handleImageLoad();
      } else {
        img.addEventListener('load', handleImageLoad);
      }
    });
  });
</script>